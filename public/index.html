<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DIAB-REG Application</title>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter", sans-serif;
    }
  </style>

  <!-- (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ) —Ç–≤–æ—ò–æ—Ç —Å—Ç–∞—Ä external /styles.css –∞–∫–æ —Ç–∏ —Ç—Ä–µ–±–∞ –∑–∞ –Ω–µ—à—Ç–æ –¥—Ä—É–≥–æ -->
  <!-- <link rel="stylesheet" href="/styles.css"/> -->
</head>
<body class="bg-slate-100 text-slate-900">


<!-- POPUP OVERLAY (BLOCKS PAGE UNTIL ACCEPTED) -->
<div id="welcomePopup"
     class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[99999] hidden">

  <div class="bg-white max-w-2xl w-[90%] rounded-2xl shadow-2xl p-6 md:p-8 border border-slate-200 relative">

    <!-- LOGO -->
    <div class="flex justify-center mb-4">
      <img src="/logo.jpg" alt="DIAB-REG Logo"
           class="h-20 w-auto rounded-xl shadow-md bg-white p-1">
    </div>

    <h2 class="text-2xl font-bold text-slate-800 mb-4 text-center">
      –î–æ–±—Ä–µ–¥–æ—ò–¥–æ–≤—Ç–µ –≤–æ DIAB-REG
    </h2>

    <div id="popupContent" class="text-slate-700 leading-relaxed">

      <p class="mb-4">
        –î–µ–Ω–µ—Å, —Ä–µ—á–∏—Å–∏ —Å–µ–∫–æ—ò –ø—Ä–æ–∏–∑–≤–æ–¥ –º–æ–∂–µ –ª–µ—Å–Ω–æ –¥–∞ –±–∏–¥–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω –∫–∞–∫–æ –ø—Ä–æ–∏–∑–≤–æ–¥ –Ω–∞–º–µ–Ω–µ—Ç –∑–∞ –¥–∏—ò–∞–±–µ—Ç–∏—á–∞—Ä–∏.
        –°—Ç—É–¥–∏–∏—Ç–µ —à—Ç–æ —Å–µ –¥–æ—Å—Ç–∞–≤—É–≤–∞–∞—Ç –¥–æ –ú–ê–õ–ú–ï–î —á–µ—Å—Ç–æ –Ω–µ –≥–∏ –æ–¥—Ä–∞–∑—É–≤–∞–∞—Ç –Ω–∞—à–∏—Ç–µ –ª–æ–∫–∞–ª–Ω–∏ —É—Å–ª–æ–≤–∏ ‚Äî –Ω–∞—á–∏–Ω–æ—Ç –Ω–∞ –∏—Å—Ö—Ä–∞–Ω–∞,
        –¥–∏–Ω–∞–º–∏–∫–∞—Ç–∞ –Ω–∞ –∂–∏–≤–æ—Ç, –Ω–∞–≤–∏–∫–∏—Ç–µ –∑–∞ —Å–ø–∏–µ—ö–µ –∏ —Å–µ–∫–æ—ò–¥–Ω–µ–≤–∏–µ—Ç–æ –Ω–∞ –ª–∏—Ü–∞—Ç–∞ —Å–æ –¥–∏—ò–∞–±–µ—Ç–µ—Å –≤–æ –°–µ–≤–µ—Ä–Ω–∞ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞.
      </p>

      <p class="mb-4">
        DIAB-REG –µ –Ω–∞—Ü–∏–æ–Ω–∞–ª–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä–¥–∏–∑–∞—Ü–∏—ò–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏ –Ω–∞–º–µ–Ω–µ—Ç–∏ –∑–∞ –¥–∏—ò–∞–±–µ—Ç–∏—á–∞—Ä–∏,
        –∫–æ—ò–∞ —Å–µ —Å–ø—Ä–æ–≤–µ–¥—É–≤–∞ –æ–¥ —Å—Ç—Ä–∞–Ω–∞ –Ω–∞ –°–æ—ò—É–∑–æ—Ç –Ω–∞ –∑–¥—Ä—É–∂–µ–Ω–∏—ò–∞ –Ω–∞ –¥–∏—ò–∞–±–µ—Ç–∏—á–∞—Ä–∏ –≤–æ —Å–æ—Ä–∞–±–æ—Ç–∫–∞ —Å–æ —Ç–∏–º –æ–¥ —Å–ø–µ—Ü–∏—ò–∞–ª–∏—Å—Ç–∏ –µ–Ω–¥–æ–∫—Ä–∏–Ω–æ–ª–æ–∑–∏.
      </p>

      <h3 class="font-semibold text-slate-900 mt-6 mb-2">–£–ø–∞—Ç—Å—Ç–≤–æ –∑–∞ –∫–æ–º–ø–∞–Ω–∏–∏</h3>

      <ul class="list-disc ml-5 space-y-1 text-sm">
        <li>–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞—ò—Ç–µ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –ø—Ä–æ—Ñ–∏–ª</li>
        <li>–ù–∞—ò–∞–≤–µ—Ç–µ —Å–µ –≤–æ —Å–∏—Å—Ç–µ–º–æ—Ç</li>
        <li>–ö—Ä–µ–∏—Ä–∞—ò—Ç–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥</li>
        <li>–ê–ø–ª–∏–∫–∞—Ü–∏—ò–∞—Ç–∞ —ò–∞ —Ä–∞–∑–≥–ª–µ–¥—É–≤–∞ –°–æ—ò—É–∑–æ—Ç –∏ —Ç–∏–º –æ–¥ –µ–Ω–¥–æ–∫—Ä–∏–Ω–æ–ª–æ–∑–∏</li>
        <li>–ú–æ–∂–Ω–æ –µ –¥–∞ –±–∏–¥–µ—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä–∞–Ω–∏ –∑–∞ –ø—Ä–∏–º–µ—Ä–æ—Ü–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ö–∞</li>
        <li>–ü—Ä–æ—Ü–µ–Ω–∫–∞—Ç–∞ —Ç—Ä–∞–µ –æ–¥ 1 –¥–æ 4 –Ω–µ–¥–µ–ª–∏</li>
        <li>–ü–æ —É–ø–ª–∞—Ç–∞ –∏ –æ–¥–æ–±—Ä—É–≤–∞—ö–µ, –ø—Ä–æ–∏–∑–≤–æ–¥–æ—Ç —Å–µ –ø–æ—ò–∞–≤—É–≤–∞ –≤–æ ‚Äû–ü–æ—Ç–≤—Ä–¥–µ–Ω–∏‚Äù</li>
      </ul>

      <p class="text-slate-700 text-sm mt-4">
        –ö–æ–Ω—Ç–∞–∫—Ç: <strong>+389 78 395 246</strong>
      </p>

      <div class="flex items-center gap-2 mt-6">
        <input type="checkbox" id="agreeTerms"
               class="h-4 w-4 text-cyan-700 rounded border-slate-300">
        <label for="agreeTerms" class="text-sm text-slate-700">
          –°–µ —Å–æ–≥–ª–∞—Å—É–≤–∞–º —Å–æ —É—Å–ª–æ–≤–∏—Ç–µ
        </label>
      </div>

      <button id="closePopupBtn"
              disabled
              class="mt-6 w-full py-3 rounded-xl bg-slate-300 text-white font-semibold cursor-not-allowed transition">
        –í–æ —Ä–µ–¥
      </button>
    </div>
  </div>
</div>


<div id="pageWrapper" class="min-h-screen flex flex-col hidden">

  <!-- ================= HEADER ================= -->
  <!-- ================= HEADER ================= -->
<header class="bg-gradient-to-r from-cyan-800 via-cyan-700 to-sky-500 text-white shadow-xl relative">

  <!-- LANGUAGE SELECT TOP-LEFT -->
  <!-- TOP BAR: WARNING + LANGUAGE SELECT -->
<div class="w-full flex items-center justify-between px-4 pt-4">

  <!-- Warning text -->
  <p class="text-red-600 text-[10px] md:text-xs font-semibold leading-tight max-w-[75%]">
    –°–∏—Å—Ç–µ–º–æ—Ç —Å–µ—É—à—Ç–µ –Ω–µ –µ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω. –°–µ–∫–æ—ò–∞ –ø–æ—Ç–≤—Ä–¥–∞ –∏–∑–¥–∞–¥–µ–Ω–∞ –º–æ–º–µ–Ω—Ç–∞–ª–Ω–æ –ø—Ä–µ–∫—É –æ–≤–æ—ò —Å–∏—Å—Ç–µ–º –Ω–µ –µ –≤–∞–∂–µ—á–∫–∞.
    –°–ª—É–∂–∏ –∏—Å–∫–ª—É—á–∏–≤–æ –∑–∞ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ –ø—Ä–µ–¥ –¥–∞ –±–∏–¥–µ –æ—Ñ–∏—Ü–∏—ò–∞–ª–Ω–æ –ø—É—à—Ç–µ–Ω –≤–æ —É–ø–æ—Ç—Ä–µ–±–∞.
  </p>

  <!-- Language selector -->
  <select id="langSelect"
    class="bg-white text-slate-800 ml-2 px-3 py-2 rounded-lg shadow-md text-sm font-medium border border-slate-300
           focus:outline-none focus:ring-2 focus:ring-sky-400">
    <option value="http://diabreg.onrender.com/" selected>–ú–∞–∫–µ–¥–æ–Ω—Å–∫–∏</option>
    <option value="http://diabreg.onrender.com/en.html">English</option>
    <option value="http://diabreg.onrender.com/al.html">Shqip</option>
  </select>

</div>


  <!-- HEADER CONTENT BELOW LANGUAGE SELECT -->
  <div class="max-w-6xl mx-auto px-4 pb-6 pt-4 flex items-center gap-4 mt-2">

    <img src="/logo.jpg" alt="DIAB-REG Logo"
         class="h-16 md:h-20 w-auto rounded-xl shadow-lg bg-white/80 p-1">

    <div>
      <h1 class="text-lg md:text-xl font-bold leading-tight">
        –°–∏—Å—Ç–µ–º –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä–¥–∏–∑–∏—Ä–∞–Ω–∏ –ø–æ—Ç–≤—Ä–¥–∏ –∏ —Ä–µ–≥—É–ª–∞—Ü–∏—ò–∞
      </h1>
      <p class="text-xs md:text-sm text-sky-100/90 mt-1">
        –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏ –Ω–∞–º–µ–Ω–µ—Ç–∏ –∑–∞ —Å–∏—Ç–µ –ª–∏—Ü–∞ —Å–æ –¥–∏—ò–∞–±–µ—Ç–µ—Å
      </p>
    </div>

  </div>

  <!-- SUPPORTED SECTION (white background) -->
  <div id="supported" class="bg-white border-t border-slate-200 shadow-inner">
    <div class="max-w-6xl mx-auto px-4 py-4 text-center">
      <p class="font-semibold text-sm tracking-wide uppercase text-slate-700 mb-3">
        –ü–æ–¥–¥—Ä–∂–∞–Ω–æ –æ–¥:
      </p>
      <div class="flex flex-wrap justify-center items-center gap-6">

  <!-- SZDM ‚Üí diabetes.com.mk -->
  <a href="https://diabetes.com.mk" target="_blank">
    <img
      class="h-10 md:h-12 object-contain bg-white/90 px-3 py-2 rounded-xl shadow transition hover:scale-105"
      src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTbBMbxYIyarbBG_HV1F3IABrK05X1i3zJHUA&s"
      alt="–°–æ—ò—É–∑ –Ω–∞ –¥–∏—ò–∞–±–µ—Ç–∏—á–∞—Ä–∏"
    >
  </a>

  <!-- IDF ‚Üí idf.org -->
  <a href="https://idf.org" target="_blank">
    <img
      class="h-10 md:h-12 object-contain bg-white/90 px-3 py-2 rounded-xl shadow transition hover:scale-105"
      src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS1cPOdSQDz5IeQzb7-284mp2ndLup06Ks6Cw&s"
      alt="IDF"
    >
  </a>

</div>

    </div>
  </div>

</header>


  <!-- ================= MAIN ================= -->
  <main class="flex-1">
    <div class="max-w-6xl mx-auto px-4 py-8 space-y-10">

      <!-- ===== INITIAL SECTION ===== -->
      <section id="initialSection" class="space-y-8">

  <!-- === Login + Register === -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- Login -->
    <div id="showLoginBtn"
         class="bg-white rounded-2xl shadow-lg hover:shadow-xl transition cursor-pointer p-7 flex flex-col items-center justify-center text-center border border-slate-200">
      <span class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 text-blue-700 mb-3 text-xl">
        üîê
      </span>
      <h3 class="text-xl font-bold text-slate-900">–ù–∞—ò–∞–≤–∏ —Å–µ</h3>
      <p class="text-sm text-slate-500 mt-1">–í–ª–µ–∑ –≤–æ —Å–∏—Å—Ç–µ–º–æ—Ç</p>
    </div>

    <!-- Register -->
    <div id="showRegisterBtn"
         class="bg-white rounded-2xl shadow-lg hover:shadow-xl transition cursor-pointer p-7 flex flex-col items-center justify-center text-center border border-slate-200">
      <span class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-purple-100 text-purple-700 mb-3 text-xl">
        ‚ûï
      </span>
      <h3 class="text-xl font-bold text-slate-900">–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞—ò —Å–µ</h3>
      <p class="text-sm text-slate-500 mt-1">–ö—Ä–µ–∏—Ä–∞—ò –Ω–æ–≤ –ø—Ä–æ—Ñ–∏–ª</p>
    </div>

  </div>

  <!-- === Highlighted / Certified === -->
  <div class="mt-4">

    <div id="btnCertified"
         class="bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-2xl shadow-xl hover:shadow-2xl transition cursor-pointer p-10 flex flex-col items-center justify-center text-center border border-emerald-600">

      <span class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-white/20 text-white text-3xl font-bold mb-4">
        ‚úì
      </span>

      <h3 class="text-3xl font-extrabold tracking-wide">
        –ü–æ—Ç–≤—Ä–¥–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏
      </h3>

      <p class="text-white/90 text-base mt-2">
        –ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–∏ –∏ –æ–¥–æ–±—Ä–µ–Ω–∏ –∞–ø–ª–∏–∫–∞—Ü–∏–∏
      </p>

    </div>
  </div>

  <!-- === Documents & Price === -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">

    <div id="btnDocs"
         class="bg-white rounded-2xl shadow-md hover:shadow-xl transition cursor-pointer p-6 text-center border border-slate-200">
      <h3 class="text-lg font-semibold text-slate-900">–î–æ–∫—É–º–µ–Ω—Ç–∏</h3>
      <p class="text-sm text-slate-500 mt-1">–∏ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏</p>
    </div>

    <div id="showPriceBtn"
         class="bg-white rounded-2xl shadow-md hover:shadow-xl transition cursor-pointer p-6 text-center border border-slate-200">
      <h3 class="text-lg font-semibold text-slate-900">–¶–µ–Ω–æ–≤–Ω–∏–∫</h3>
      <p class="text-sm text-slate-500 mt-1">–¥–µ—Ç–∞–ª–µ–Ω –ø—Ä–∏–∫–∞–∑</p>
    </div>

  </div>

  <!-- GDPR -->
  <div id="gdprMessage"
       class="bg-white rounded-2xl shadow-md border border-emerald-100 p-6">
    <strong class="block text-slate-900">
      DIAB-REG —Å–æ–±–∏—Ä–∞, –æ–±—Ä–∞–±–æ—Ç—É–≤–∞ –∏ —á—É–≤–∞ —Å–∞–º–æ –ø–æ–¥–∞—Ç–æ—Ü–∏ –∫–æ–∏ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –ø—Ä–∞–≤–Ω–∏ —Å—É–±—ò–µ–∫—Ç–∏:
    </strong>
    <ul class="list-disc ml-5 mt-3 text-slate-700 text-sm space-y-1">
      <li>–ù–∞–∑–∏–≤ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—ò–∞</li>
      <li>–ï–ú–ë–°</li>
      <li>–ù–∞–∑–∏–≤ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥</li>
      <li>–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</li>
      <li>–î–∞—Ç—É–º</li>
    </ul>
    <p class="text-slate-500 text-xs mt-2">
      –ë–µ–∑ –ª–∏—á–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏. –ù–µ–º–∞ –∫–æ–ª–∞—á–∏—ö–∞ –∑–∞ —Å–ª–µ–¥–µ—ö–µ.
    </p>
  </div>

  <div id="docsList" class="text-sm text-slate-700"></div>

</section>


      <!-- ===== CERTIFIED SECTION ===== -->
      <section id="certifiedSection" class="hidden space-y-6">

  <button id="backFromCertified"
          class="inline-flex items-center text-sm font-medium text-sky-700 hover:text-sky-900 transition duration-200">
    &larr; –ù–∞–∑–∞–¥
  </button>

  <h2 class="text-2xl font-extrabold text-slate-900 tracking-tight">
    –ü–æ—Ç–≤—Ä–¥–µ–Ω–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏
  </h2>

  <!-- FILTERS -->
  <div class="bg-white rounded-2xl shadow-md border border-slate-200 p-6 space-y-4">

    <h3 class="text-lg font-semibold text-slate-800">–§–∏–ª—Ç—Ä–∏—Ä–∞—ö–µ</h3>

    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <input id="filterIdCert" type="text"
             placeholder="ID..."
             class="p-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-sky-400"/>

      <input id="filterDateCert" type="text"
             placeholder="–î–∞—Ç—É–º..."
             class="p-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-sky-400"/>

      <input id="filterCompanyCert" type="text"
             placeholder="–ö–æ–º–ø–∞–Ω–∏—ò–∞..."
             class="p-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-sky-400"/>

      <input id="filterProductCert" type="text"
             placeholder="–ü—Ä–æ–¥—É–∫—Ç..."
             class="p-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-sky-400"/>
    </div>

  </div>

  <!-- TABLE -->
  <div class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">

    <div class="bg-gradient-to-r from-emerald-600 to-teal-500 text-white font-semibold p-4">
      –°–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–∏ –±–∞—Ä–∞—ö–∞
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full text-sm">

        <thead class="bg-slate-800 text-white">
          <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">

            <th class="px-4 py-3 text-left">ID</th>
            <th class="px-4 py-3 text-left">Created At</th>
            <th class="px-4 py-3 text-left">Company</th>
            <th class="px-4 py-3 text-left">Product</th>
            <th class="px-4 py-3 text-left">Contact</th>
            <th class="px-4 py-3 text-left">Email</th>
            <th class="px-4 py-3 text-left">Status</th>
            <th class="px-4 py-3 text-left">Certificate</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-slate-100">
          <!-- POPULATED BY JS -->
        </tbody>

      </table>
    </div>

  </div>

</section>


      <!-- ===== LOGIN SECTION ===== -->
      <section id="loginSection" class="hidden">
        <button id="backFromLogin"
                class="inline-flex items-center text-sm font-medium text-sky-700 hover:text-sky-900 mb-4">
          &larr; –í—Ä–∞—Ç–∏ —Å–µ –Ω–∞ –ø–æ—á–µ—Ç–æ–∫
        </button>

        <div class="max-w-md mx-auto bg-white rounded-2xl shadow-md border border-slate-100 p-6">
          <h2 class="text-xl font-semibold text-center text-slate-900">–ù–∞—ò–∞–≤–∞</h2>
          <form id="loginForm" class="mt-5 space-y-4">
            <div>
              <label class="block text-sm text-slate-700 mb-1">–ú–∞—Ç–∏—á–µ–Ω –±—Ä–æ—ò (–ï–ú–ë–°)</label>
              <input type="text" id="loginMat" required
                     placeholder="–í–Ω–µ—Å–µ—Ç–µ –≥–æ –≤–∞—à–∏–æ—Ç –º–∞—Ç–∏—á–µ–Ω –±—Ä–æ—ò"
                     class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400">
            </div>
            <div>
              <label class="block text-sm text-slate-700 mb-1">–õ–æ–∑–∏–Ω–∫–∞</label>
              <input type="password" id="loginPass" required
                     placeholder="–í–Ω–µ—Å–µ—Ç–µ —ò–∞ –≤–∞—à–∞—Ç–∞ –ª–æ–∑–∏–Ω–∫–∞"
                     class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400">
            </div>
            <button type="submit"
                    class="w-full py-2.5 rounded-lg bg-sky-600 text-white text-sm font-semibold hover:bg-sky-700 transition">
              –ù–∞—ò–∞–≤–∏ —Å–µ
            </button>
          </form>
        </div>
      </section>

      <!-- ===== REGISTER SECTION ===== -->
      <section id="registerSection" class="hidden">
        <button id="backFromRegister"
                class="inline-flex items-center text-sm font-medium text-sky-700 hover:text-sky-900 mb-4">
          &larr; –í—Ä–∞—Ç–∏ —Å–µ –Ω–∞ –ø–æ—á–µ—Ç–æ–∫
        </button>

        <div class="max-w-md mx-auto bg-white rounded-2xl shadow-md border border-slate-100 p-6">
          <h2 class="text-xl font-semibold text-center text-slate-900">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞</h2>

          <form id="registerForm" class="mt-5 space-y-4">
            <div>
              <label class="block text-sm text-slate-700 mb-1">–ú–∞—Ç–∏—á–µ–Ω –±—Ä–æ—ò (–ï–ú–ë–°)</label>
              <input type="text" name="matichen_broj" required
                     class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
            </div>

            <div>
              <label class="block text-sm text-slate-700 mb-1">–ò–º–µ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—ò–∞</label>
              <input type="text" name="name" required
                     class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
            </div>

            <div>
              <label class="block text-sm text-slate-700 mb-1">–ï-–ø–æ—à—Ç–∞</label>
              <input type="email" name="email" required
                     class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
            </div>

            <div>
              <label class="block text-sm text-slate-700 mb-1">–õ–æ–∑–∏–Ω–∫–∞</label>
              <input type="password" name="password" id="password" required
                     class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
            </div>

            <button type="submit" id="registerBtn"
                    class="w-full py-2.5 rounded-lg bg-sky-600 text-white text-sm font-semibold hover:bg-sky-700 transition">
              –†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞—ò —Å–µ
            </button>
          </form>
        </div>
      </section>

      <!-- ===== AFTER LOGIN SECTION ===== -->
      <section id="afterLoginSection" class="hidden space-y-6">
        <button id="backFromAfterLogin"
                class="inline-flex items-center text-sm font-medium text-rose-700 hover:text-rose-900 mb-2">
          &larr; –û–¥—ò–∞–≤–∏ —Å–µ
        </button>

        <div class="bg-white rounded-2xl shadow-md border border-slate-100 p-6 space-y-6">
          <div>
            <h2 class="text-xl font-semibold text-slate-900">–î–æ–±—Ä–µ–¥–æ—ò–¥–æ–≤—Ç–µ!</h2>
            <p class="text-sm text-slate-600 mt-1">
              –ú–æ–∂–µ—Ç–µ –¥–∞ –ø–æ–¥–Ω–µ—Å—É–≤–∞—Ç–µ –∞–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ –¥–∞ –≥–∏ –ø—Ä–æ–≤–µ—Ä—É–≤–∞—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏—Ç–µ.
            </p>
          </div>
 <button id="btnMyApps"
              class="hidden ml-3 px-3 py-1.5 text-xs rounded-full bg-sky-600 text-white hover:bg-sky-700">
        –ú–æ–∏ –∞–ø–ª–∏–∫–∞—Ü–∏–∏
      </button>
          <!-- –ü–æ–¥–Ω–µ—Å–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ -->
          <div id="applySection" class="border-t border-slate-100 pt-4 space-y-4">
            <h3 class="text-lg font-semibold text-slate-900">–ü–æ–¥–Ω–µ—Å–∏ –Ω–æ–≤–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞</h3>
            <form id="applicationForm"
                  action="/apply-and-pay"
                  method="POST"
                  enctype="multipart/form-data"
                  class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="col-span-1">
                <label class="block text-sm text-slate-700 mb-1">–ö–æ–Ω—Ç–∞–∫—Ç –ª–∏—Ü–µ</label>
                <input type="text" name="contact" required
                       class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
              </div>
              <div class="col-span-1">
                <label class="block text-sm text-slate-700 mb-1">–ö–æ–Ω—Ç–∞–∫—Ç –µ-–ø–æ—à—Ç–∞</label>
                <input type="email" name="email" required
                       class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
              </div>

              <div class="col-span-1">
                <label class="block text-sm text-slate-700 mb-1">–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</label>
                <select name="category" id="categorySelect" required
                        class="w-full p-2.5 border rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-sky-400">
                  <option value="">‚Äì –ò–∑–±–µ—Ä–∏ ‚Äì</option>
                  <option value="–î–æ–¥–∞—Ç–æ—Ü–∏ –∏ –ø–æ—Ç—Ä–æ—à–µ–Ω –º–∞—Ç–µ—Ä–∏—ò–∞–ª">–î–æ–¥–∞—Ç–æ—Ü–∏ –∏ –ø–æ—Ç—Ä–æ—à–µ–Ω –º–∞—Ç–µ—Ä–∏—ò–∞–ª (45 ‚Ç¨)</option>
                  <option value="–ü–æ—Ç—Ä–æ—à–µ–Ω –º–∞—Ç–µ—Ä–∏—ò–∞–ª –∑–∞ –º–µ—Ä–µ—ö–µ/–∏–Ω—ò–µ–∫—Ç–∏—Ä–∞—ö–µ">–ü–æ—Ç—Ä–æ—à–µ–Ω –º–∞—Ç–µ—Ä–∏—ò–∞–ª –∑–∞ –º–µ—Ä–µ—ö–µ/–∏–Ω—ò–µ–∫—Ç–∏—Ä–∞—ö–µ (65 ‚Ç¨)</option>
                  <option value="–£—Ä–µ–¥–∏ –∑–∞ –º–µ—Ä–µ—ö–µ">–£—Ä–µ–¥–∏ –∑–∞ –º–µ—Ä–µ—ö–µ (125 ‚Ç¨)</option>
                  <option value="–£—Ä–µ–¥–∏ –∑–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –Ω–∞ –∏–Ω—Å—É–ª–∏–Ω">–£—Ä–µ–¥–∏ –∑–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –Ω–∞ –∏–Ω—Å—É–ª–∏–Ω (170 ‚Ç¨)</option>
                  <option value="–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏ —Å–∏—Å—Ç–µ–º–∏">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏ —Å–∏—Å—Ç–µ–º–∏ (260 ‚Ç¨)</option>
                </select>
              </div>

              <div class="col-span-1">
                <label class="block text-sm text-slate-700 mb-1">–ò–º–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç</label>
                <input type="text" name="product" required
                       class="w-full p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
              </div>

              <div class="col-span-1 md:col-span-2">
                <label class="block text-sm text-slate-700 mb-1">–ü—Ä–∏–∫–∞—á–µ—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏</label>
                <input type="file" name="docs" multiple required
                       class="w-full text-sm border rounded-lg p-2.5 bg-slate-50"/>
              </div>

              <div class="col-span-1 md:col-span-2 flex items-start gap-2 text-xs text-slate-700">
                <input type="checkbox" id="acceptTerms"
                       class="mt-1 h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500">
                <a href="/uslov/uslov.pdf" id="termsLink" target="_blank"
                   class="underline text-sky-700 hover:text-sky-900">
                  –ì–∏ –ø—Ä–∏—Ñ–∞—ú–∞–º —É—Å–ª–æ–≤–∏—Ç–µ –∑–∞ –Ω–∞–ø–ª–∞—Ç–∞ –ø–æ —Ñ–∞–∫—Ç—É—Ä–∞ —Å–æ–≥–ª–∞—Å–Ω–æ DIAB-REG
                </a>
              </div>

              <div class="col-span-1 md:col-span-2">
                <button id="submitBtn" type="submit" disabled
                        class="w-full py-2.5 rounded-lg text-sm font-semibold text-white bg-slate-400 cursor-not-allowed">
                  –ü–æ–¥–Ω–µ—Å–∏ –ê–ø–ª–∏–∫–∞—Ü–∏—ò–∞
                </button>
              </div>
            </form>
          </div>

          <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å -->
          <div id="statusSection" class="hidden border-t border-slate-100 pt-4 space-y-3">
            <h3 class="text-lg font-semibold text-slate-900">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å</h3>
            <div class="flex flex-col md:flex-row gap-3 items-stretch md:items-center">
              <input type="text" id="statusId"
                     placeholder="–í–Ω–µ—Å–µ—Ç–µ ID –Ω–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞"
                     class="flex-1 p-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"/>
              <button id="checkBtn"
                      class="px-4 py-2.5 rounded-lg bg-sky-600 text-white text-sm font-semibold hover:bg-sky-700 transition">
                –ü—Ä–æ–≤–µ—Ä–∏
              </button>
            </div>
            <div id="statusResult"
                 class="text-sm bg-slate-50 border border-emerald-100 rounded-xl p-4 min-h-[40px]"></div>
            <button id="backFromStatus"
                    class="inline-flex items-center text-xs font-medium text-slate-600 hover:text-slate-800">
              &larr; –ù–∞–∑–∞–¥
            </button>
          </div>

          <!-- –î–æ–∫—É–º–µ–Ω—Ç–∏/–¶–µ–Ω–æ–≤–Ω–∏–∫ –∏ –ø–æ –Ω–∞—ò–∞–≤–∞ -->
          <div class="border-t border-slate-100 pt-4 flex flex-wrap gap-3">
            <button id="btnDocs"
                    class="px-4 py-2.5 rounded-lg bg-slate-100 text-sm font-medium text-slate-800 hover:bg-slate-200">
              –î–æ–∫—É–º–µ–Ω—Ç–∏ –∏ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏
            </button>
            <button id="showPriceBtn"
                    class="px-4 py-2.5 rounded-lg bg-slate-100 text-sm font-medium text-slate-800 hover:bg-slate-200">
              –¶–µ–Ω–æ–≤–Ω–∏–∫
            </button>
          </div>

          <div id="docsList" class="text-sm text-slate-700"></div>

          <!-- GDPR –ø–æ–≤—Ç–æ—Ä–Ω–æ -->
          <div class="border-t border-slate-100 pt-4">
            <p class="text-sm font-semibold text-slate-900">
              DIAB-REG —Å–æ–±–∏—Ä–∞, –æ–±—Ä–∞–±–æ—Ç—É–≤–∞ –∏ —á—É–≤–∞ —Å–∞–º–æ –ø–æ–¥–∞—Ç–æ—Ü–∏ –∫–æ–∏ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –ø—Ä–∞–≤–Ω–∏ —Å—É–±—ò–µ–∫—Ç–∏:
            </p>
            <ul class="list-disc ml-5 mt-2 text-xs text-slate-700 space-y-1">
              <li>–ù–∞–∑–∏–≤ –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—ò–∞</li>
              <li>–ï–ú–ë–°</li>
              <li>–ù–∞–∑–∏–≤ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥</li>
              <li>–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</li>
              <li>–î–∞—Ç—É–º</li>
            </ul>
            <p class="text-xs text-slate-500 mt-1">–ë–µ–∑ –ª–∏—á–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏. –ù–µ–º–∞ –∫–æ–ª–∞—á–∏—ö–∞ –∑–∞ —Å–ª–µ–¥–µ—ö–µ.</p>
          </div>
        </div>
      </section>

      <!-- ===== MY APPS SECTION ===== -->
      <section id="myAppsSection" class="hidden space-y-6">

  <button id="backFromMyApps"
          class="inline-flex items-center text-sm font-medium text-sky-700 hover:text-sky-900 transition duration-200">
    &larr; –ù–∞–∑–∞–¥
  </button>

  
  <div class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">
<h2 class="text-2xl font-extrabold text-slate-900 tracking-tight">
    –ú–æ–∏ –∞–ø–ª–∏–∫–∞—Ü–∏–∏
  </h2>

    <div class="bg-gradient-to-r from-sky-700 to-blue-600 text-white font-semibold p-4">
      –õ–∏—Å—Ç–∞ –Ω–∞ –≤–∞—à–∏—Ç–µ –ø–æ–¥–Ω–µ—Å–µ–Ω–∏ –∞–ø–ª–∏–∫–∞—Ü–∏–∏
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full text-sm">

        <thead class="bg-slate-900 text-white">
          <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">

            <th class="px-4 py-3 text-left">ID</th>
            <th class="px-4 py-3 text-left">–î–∞—Ç–∞</th>
            <th class="px-4 py-3 text-left">–ü—Ä–æ–¥—É–∫—Ç</th>
            <th class="px-4 py-3 text-left">–°—Ç–∞—Ç—É—Å</th>
            <th class="px-4 py-3 text-left">Cert. No.</th>
            <th class="px-4 py-3 text-left">–ü—Ä–µ–≥–ª–µ–¥</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-slate-100">
          <!-- JS –≥–æ –ø–æ–ª–Ω–∏ -->
        </tbody>

      </table>
    </div>

  </div>

</section>


      <!-- ===== –ì–ê–õ–ï–†–ò–à–ê –ü–ê–†–¢–ù–ï–†–ò ===== -->
      <section>
        <div id="gallery"
             class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-w-3xl mx-auto">
          <!-- –ø–æ–ø–æ–ª–Ω—É–≤–∞ JS -->
        </div>
      </section>

    </div>
  </main>

  <!-- ================= FOOTER ================= -->
  <footer class="border-t border-slate-200 bg-white/90">
    <div class="max-w-6xl mx-auto px-4 py-6 text-center text-xs md:text-sm text-slate-500">
      ¬© 2025 DIAB-REG –°–∏—Å—Ç–µ–º –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä–¥–∏–∑–∏—Ä–∞–Ω–∏ –ø–æ—Ç–≤—Ä–¥–∏. –°–∏—Ç–µ –ø—Ä–∞–≤–∞ —Å–µ –∑–∞–¥—Ä–∂–∞–Ω–∏.
     
    </div>
  </footer>
</div>

<!-- ================= JS (–æ–¥ —Ç–≤–æ—ò–æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–µ–Ω —Ñ–∞—ò–ª) ================= -->
<script>
  const images = [
    'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQhyHn4MpY9UEEmWgfjxVh3JAqXveq9_2wZw&s',
    'https://upload.wikimedia.org/wikipedia/en/b/b1/Novo_Nordisk_-_Logo.svg',
    'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f4/F._Hoffmann-La_Roche_2021_logo.svg/1200px-F._Hoffmann-La_Roche_2021_logo.svg.png',
    'https://farmaon.al/wp-content/uploads/2023/04/e22bd229-helathyl08-favio-forte.jpg'
  ];

  document.addEventListener('DOMContentLoaded', () => {
    const langSelect = document.getElementById('langSelect');
    langSelect.addEventListener('change', e => {
      window.location.href = e.target.value;
    });
  });

  const gallery = document.getElementById('gallery');

  // –ü—Ä–∏–∫–∞–∂–∏ –≥–∏ —Å–ª–∏–∫–∏—Ç–µ
  function renderGallery() {
    gallery.innerHTML = '';
    images.forEach(src => {
      const frame = document.createElement('div');
      frame.className = 'bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden';
      const img = document.createElement('img');
      img.src = src;
      img.className = 'w-full h-24 sm:h-28 md:h-32 object-contain bg-slate-50';
      frame.appendChild(img);
      gallery.appendChild(frame);
    });
  }

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  renderGallery();
  setInterval(() => {
    shuffleArray(images);
    renderGallery();
  }, 15000);

  let token = null;
  const initial    = document.getElementById('initialSection');
  const certified  = document.getElementById('certifiedSection');
  const loginSec   = document.getElementById('loginSection');
  const regSec     = document.getElementById('registerSection');
  const after      = document.getElementById('afterLoginSection');
  const myAppsSec  = document.getElementById('myAppsSection');
  const docsList   = document.getElementById('docsList');

  const form       = document.getElementById('applicationForm');
  const submitBtn  = document.getElementById('submitBtn');
  const acceptTerms= document.getElementById('acceptTerms');

  // –µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–æ: —Å–∞–º–æ —É—Å–ª–æ–≤–∏—Ç–µ –¥–∞ —Å–µ –ø—Ä–∏—Ñ–∞—Ç–µ–Ω–∏
  acceptTerms.addEventListener('change', () => {
    submitBtn.disabled = !acceptTerms.checked;
    if (submitBtn.disabled) {
      submitBtn.classList.remove('bg-sky-600','cursor-pointer');
      submitBtn.classList.add('bg-slate-400','cursor-not-allowed');
    } else {
      submitBtn.classList.remove('bg-slate-400','cursor-not-allowed');
      submitBtn.classList.add('bg-sky-600','cursor-pointer');
    }
  });

  // –ù–∞–≤–∏–≥–∞—Ü–∏—ò–∞
  document.getElementById('showLoginBtn').onclick       = ()=>{
    initial.classList.add('hidden');
    loginSec.classList.remove('hidden');
  };
  document.getElementById('backFromLogin').onclick      = ()=>{
    loginSec.classList.add('hidden');
    initial.classList.remove('hidden');
  };
  document.getElementById('showRegisterBtn').onclick    = ()=>{
    initial.classList.add('hidden');
    regSec.classList.remove('hidden');
  };
  document.getElementById('backFromRegister').onclick   = ()=>{
    regSec.classList.add('hidden');
    initial.classList.remove('hidden');
  };
  document.getElementById('backFromAfterLogin').onclick = ()=>{
    token = null;
    after.classList.add('hidden');
    initial.classList.remove('hidden');
  };
  document.getElementById('backFromStatus').onclick     = ()=>{
    document.getElementById('statusSection').classList.add('hidden');
    document.getElementById('applySection').classList.remove('hidden');
  };
  document.getElementById('backFromMyApps').onclick     = ()=>{
    myAppsSec.classList.add('hidden');
    after.classList.remove('hidden');
  };
  document.getElementById('backFromCertified').onclick  = ()=>{
    certified.classList.add('hidden');
    initial.classList.remove('hidden');
  };

// –°–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–∏ –æ–¥ DIAB-REG
document.getElementById('btnCertified').addEventListener('click', async () => {
  initial.classList.add('hidden');
  certified.classList.remove('hidden');

  try {
    const res = await fetch('/api/public/completed');
    if (!res.ok) {
      console.error('Failed to load completed applications', res.status);
      alert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤—á–∏—Ç—É–≤–∞—ö–µ');
      return;
    }

    const apps = await res.json(); // ‚Üê –û–í–ê –ï –ö–õ–£–ß–ù–û

    const tb = certified.querySelector('tbody');
    tb.innerHTML = apps.map(a => {
      const createdAt = a.createdAt ? new Date(a.createdAt).toLocaleString('mk-MK') : '';
      const companyName = a.company?.name || '';
      const certLink = a.cert_number
        ? `<a class="text-sky-700 underline" href="/confirm/${encodeURIComponent(a.cert_number)}" target="_blank">${a.cert_number}</a>`
        : '';
      const contact = a.contact || '';
      const email = a.email || '';
      const status = a.status || '';

      return `<tr class="hover:bg-slate-50">
        <td class="px-3 py-2">${a._id || ''}</td>
        <td class="px-3 py-2">${createdAt}</td>
        <td class="px-3 py-2">${companyName}</td>
        <td class="px-3 py-2">${a.product || ''}</td>
        <td class="px-3 py-2">${contact}</td>
        <td class="px-3 py-2">${email}</td>
        <td class="px-3 py-2">${status}</td>
        <td class="px-3 py-2">${certLink}</td>
      </tr>`;
    }).join('');
  } catch (err) {
    console.error('Error loading completed applications', err);
    alert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤—á–∏—Ç—É–≤–∞—ö–µ');
  }
});


// –î–æ–∫—É–º–µ–Ω—Ç–∏ –∏ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏
  document.querySelectorAll('#btnDocs').forEach(el=>{
    el.addEventListener('click', async () => {
      try {
        const res  = await fetch('/api/documents');
        if (!res.ok) throw new Error();
        const json = await res.json();
        const docsHtml = json.files
          .map(f => `<li><a href="/documents/${encodeURIComponent(f)}" target="_blank">${f}</a></li>`)
          .join('');
        const popup = window.open('', 'docsPopup', 'width=600,height=400');
        popup.document.write(`
          <!DOCTYPE html>
          <html lang="mk">
          <head>
            <meta charset="UTF-8"/>
            <title>–î–æ–∫—É–º–µ–Ω—Ç–∏ –∏ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏</title>
            <style>
              body { font-family: system-ui, sans-serif; padding:20px; }
              h3 { color: #0369a1; }
              ul { list-style: none; padding-left: 0; }
              li { margin: 8px 0; }
              a { color: #0369a1; text-decoration: none; }
              a:hover { text-decoration: underline; }
            </style>
          </head>
          <body>
            <h3>–î–æ–∫—É–º–µ–Ω—Ç–∏ –∏ —Ä–µ–≥—É–ª–∞—Ç–∏–≤–∏</h3>
            <ul>${docsHtml}</ul>
          </body>
          </html>
        `);
      } catch (e) {
        alert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤—á–∏—Ç—É–≤–∞—ö–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏');
      }
    });
  });

  // –¶–µ–Ω–æ–≤–Ω–∏–∫
  document.querySelectorAll('#showPriceBtn').forEach(el=>{
    el.addEventListener('click', ()=>{
      const priceTable = `
        <h3>–¶–µ–Ω–æ–≤–Ω–∏–∫ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏ (–ú–ö–î)</h3>
        <table border="1" cellpadding="5" cellspacing="0" style="border-collapse:collapse;margin:10px auto;font-family:sans-serif;font-size:13px;">
          <thead><tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">
<th>–ö–∞—Ç–µ–≥–æ—Ä–∏—ò–∞</th><th>–ü—Ä–∏–º–µ—Ä–∏</th><th>–¶–µ–Ω–∞(–ú–ö–î)</th></tr></thead>
          <tbody>
            <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">
<td>–î–æ–¥–∞—Ç–æ—Ü–∏ –∏ –ø–æ—Ç—Ä–æ—à–µ–Ω –º–∞—Ç–µ—Ä–∏—ò–∞–ª</td><td>–õ–µ–ø–µ–Ω–∫–∏, –Ω–∞–ª–µ–ø–Ω–∏—Ü–∏, –Ω–æ—Å–∞—á–∏</td><td>2500</td></tr>
            <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">
<td>–ü–æ—Ç—Ä–æ—à–µ–Ω –º–∞—Ç–µ—Ä–∏—ò–∞–ª –∑–∞ –º–µ—Ä–µ—ö–µ/–∏–Ω—ò–µ–∫—Ç–∏—Ä–∞—ö–µ</td><td>–¢–µ—Å—Ç –ª–µ–Ω—Ç–∏, –∏–≥–ª–∏, –∫–∞—Ç–µ—Ç—Ä–∏</td><td>4000</td></tr>
            <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">
<td>–£—Ä–µ–¥–∏ –∑–∞ –º–µ—Ä–µ—ö–µ</td><td>–ì–ª—É–∫–æ–º–µ—Ç—Ä–∏, CGM, —Å–µ–Ω–∑–æ—Ä–∏</td><td>7500</td></tr>
            <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">
<td>–£—Ä–µ–¥–∏ –∑–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –Ω–∞ –∏–Ω—Å—É–ª–∏–Ω</td><td>–ò–Ω—Å—É–ª–∏–Ω—Å–∫–∏ –ø–µ–Ω–∫–∞–ª–∞, Jet injectors</td><td>10000</td></tr>
            <tr class="transition-all duration-200 hover:bg-slate-50 hover:scale-[1.01]">
<td>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏ —Å–∏—Å—Ç–µ–º–∏</td><td>–ò–Ω—Å—É–ª–∏–Ω—Å–∫–∏ –ø—É–º–ø–∏, —Ö–∏–±—Ä–∏–¥–Ω–∏ —Å–∏—Å—Ç–µ–º–∏</td><td>15000</td></tr>
          </tbody>
        </table>`;
      const w = window.open('','price','width=600,height=400');
      w.document.write(`<html><body>${priceTable}</body></html>`);
    });
  });

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞
  document.getElementById('registerForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const data = Object.fromEntries(new FormData(e.target).entries());
    const res  = await fetch('/api/auth/register',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(data)
    });
    const json = await res.json();
    if(json.success){
      alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞ —É—Å–ø–µ—à–Ω–∞!');
      regSec.classList.add('hidden');
      loginSec.classList.remove('hidden');
    } else alert('–ì—Ä–µ—à–∫–∞: '+(json.error||''));
  });

  // –õ–æ–≥–∏–Ω
  document.getElementById('loginForm').addEventListener('submit', async e=>{
    e.preventDefault();
    const body = {
      matichen_broj: document.getElementById('loginMat').value,
      password:      document.getElementById('loginPass').value
    };
    const res = await fetch('/api/auth/login',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(body)
    });
    const json = await res.json();
    if(json.token){
      token = json.token;
      alert('–ù–∞—ò–∞–≤a —É—Å–ø–µ—à–Ω–∞!');
      loginSec.classList.add('hidden');
      after.classList.remove('hidden');
      document.getElementById('btnMyApps').classList.remove('hidden');
    } else alert('Login failed: '+(json.error||''));
  });

  // –ü–æ–¥–Ω–µ—Å–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞
  form.addEventListener('submit', async e => {
    e.preventDefault();
    if (!token) return alert('–ú–æ—Ä–∞ –¥–∞ —Å–µ –Ω–∞—ò–∞–≤–∏—à');
    if (!acceptTerms.checked) return alert('–ú–æ—Ä–∞ –¥–∞ –≥–∏ –ø—Ä–∏—Ñ–∞—Ç–∏—Ç–µ —É—Å–ª–æ–≤–∏—Ç–µ');

    const fd = new FormData(form);
    const applyRes  = await fetch('/api/apply', {
      method: 'POST',
      headers: { 'Authorization': 'Bearer ' + token },
      body: fd
    });
    const applyJson = await applyRes.json();
    if (!applyJson.id) {
      return alert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –ø–æ–¥–Ω–µ—Å—É–≤–∞—ö–µ: ' + (applyJson.error||''));
    }
    alert('–ê–ø–ª–∏–∫–∞—Ü–∏—ò–∞—Ç–∞ –µ –ø–æ–¥–Ω–µ—Å–µ–Ω–∞! –í–∞—à–µ—Ç–æ ID –µ ' + applyJson.id);
  });

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å
  document.getElementById('checkBtn').addEventListener('click', async () => {
    const id  = document.getElementById('statusId').value;
    const res = await fetch('/api/status/'+encodeURIComponent(id), {
      headers: { 'Authorization': 'Bearer ' + token }
    });
    const json= await res.json();
    const r   = document.getElementById('statusResult');

    if (!json.found) {
      r.innerText = '–ù–µ –ø—Ä–æ–Ω–∞—ò–¥–µ–Ω–æ.';
    } else {
      const { status, company, cert_number } = json.application;
      r.innerHTML =
        `<strong class="inline-block min-w-[70px] text-slate-800">ID:</strong> ${id}<br>
         <strong class="inline-block min-w-[70px] text-slate-800">–°—Ç–∞—Ç—É—Å:</strong> ${status}<br>
         <strong class="inline-block min-w-[70px] text-slate-800">Company:</strong> ${company}` +
        (status === 'Completed' && cert_number
          ? `<br><br>
             <a class="text-sky-700 underline" href="/confirm/${encodeURIComponent(cert_number)}" target="_blank">
               –ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç ${cert_number}
             </a>`
          : '');
    }

    document.getElementById('applySection').classList.add('hidden');
    document.getElementById('statusSection').classList.remove('hidden');
  });

  // –ú–æ–∏ –∞–ø–ª–∏–∫–∞—Ü–∏–∏
  document.getElementById('btnMyApps').addEventListener('click', async ()=>{
    if(!token) return alert('–ú–æ—Ä–∞ –¥–∞ —Å–µ –Ω–∞—ò–∞–≤–∏—à');
    after.classList.add('hidden');
    myAppsSec.classList.remove('hidden');
    const res = await fetch('/api/my/applications',{headers:{'Authorization':'Bearer '+token}});
    if(!res.ok) return alert('–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤—á–∏—Ç—É–≤–∞—ö–µ –∞–ø–ª–∏–∫–∞—Ü–∏–∏');
    const apps = await res.json();
    const tb = myAppsSec.querySelector('tbody');
    tb.innerHTML = apps.map(app=>{
      const d = new Date(app.createdAt).toLocaleString('mk-MK');
      const cert = app.cert_number ? `<a class="text-sky-700 underline" href="/confirm/${encodeURIComponent(app.cert_number)}">${app.cert_number}</a>` : '-';
      const view = app.cert_number ? `<a class="text-sky-700 underline" href="/confirm/${encodeURIComponent(app.cert_number)}">–ü—Ä–µ–≥–ª–µ–¥</a>` : '-';
      return `<tr class="hover:bg-slate-50">
        <td class="px-3 py-2">${app._id}</td>
        <td class="px-3 py-2">${d}</td>
        <td class="px-3 py-2">${app.product}</td>
        <td class="px-3 py-2">${app.status}</td>
        <td class="px-3 py-2">${cert}</td>
        <td class="px-3 py-2">${view}</td>
      </tr>`;
    }).join('');
  });

  // Terms –≤–æ –Ω–æ–≤ –ø—Ä–æ–∑–æ—Ä–µ—Ü
  document.addEventListener('DOMContentLoaded', () => {
    const termsLink = document.getElementById('termsLink');
    if (termsLink) {
      termsLink.addEventListener('click', e => {
        e.preventDefault();
        window.open(
          '/uslov.pdf',
          'UsloviPDF',
          'width=800,height=600,toolbar=no,location=no,status=no,menubar=no,scrollbars=yes'
        );
      });
    }
  });
  
  // =====================
// POPUP APPEAR EVERY 10 VISITS
// =====================

window.addEventListener('DOMContentLoaded', () => {
  const popup = document.getElementById('welcomePopup');
  const agree = document.getElementById('agreeTerms');
  const closeBtn = document.getElementById('closePopupBtn');

  // Count visits in localStorage
  let visits = localStorage.getItem('diabreg_visits');
  visits = visits ? parseInt(visits) + 1 : 1;
  localStorage.setItem('diabreg_visits', visits);

  // Show popup on first visit and then on every 10th visit
  const page = document.getElementById('pageWrapper');

  if (visits === 1 || visits % 10 === 0) {
    popup.classList.remove('hidden');
    document.body.style.overflow = "hidden"; // block scrolling
  } else if (page) {
    // If popup is not shown, show the page content immediately
    page.classList.remove('hidden');
  }

  // Enable button after checkbox
  agree.addEventListener('change', () => {
    const ok = agree.checked;
    closeBtn.disabled = !ok;
    closeBtn.classList.toggle('cursor-not-allowed', !ok);
    closeBtn.classList.toggle('bg-slate-300', !ok);
    closeBtn.classList.toggle('bg-cyan-700', ok);
  });

  // Close popup & unlock page
  closeBtn.addEventListener('click', () => {
    popup.classList.add('hidden');
    document.body.style.overflow = "auto";
    if (page) page.classList.remove('hidden');
  });
});

</script>


</body>
</html>
